<HEAD>
<TITLE>Documentation of the module curl</TITLE>

<META NAME="description" CONTENT="Documentation of the module curl: Table of Contents">
<META NAME="keywords" CONTENT="Documentation of the module curl: Table of Contents">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="t2h.pl">

</HEAD>

<BODY LANG="" BGCOLOR="#C7C1A7" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<FONT FACE="Verdana" Size="2">

<H1>Documentation of the module curl</H1>
<H3>by Peter Verhas</H3>
<A NAME="contents"><H2>Table of Contents</H2></A>
<UL>
<A HREF="#1.">1.   Introduction</A><BR>
<A HREF="#2.">2.   curl::init</A><BR>
<A HREF="#3.">3.   curl::option</A><BR>
<UL>
<A HREF="#3.1.">3.1.   BUFFER_SIZE integer</A><BR>
<A HREF="#3.2.">3.2.   CAINFO string</A><BR>
<A HREF="#3.3.">3.3.   COOKIE string</A><BR>
<A HREF="#3.4.">3.4.   COOKIEFILE string</A><BR>
<A HREF="#3.5.">3.5.   CUSTOMREQUEST string</A><BR>
<A HREF="#3.6.">3.6.   FILE</A><BR>
<A HREF="#3.7.">3.7.   FTPPORT string</A><BR>
<A HREF="#3.8.">3.8.   HEADERFILE string</A><BR>
<A HREF="#3.9.">3.9.   INFILE string</A><BR>
<A HREF="#3.10.">3.10.   INTERFACE string</A><BR>
<A HREF="#3.11.">3.11.   INTEXT string</A><BR>
<A HREF="#3.12.">3.12.   KRB4LEVEL string</A><BR>
<A HREF="#3.13.">3.13.   PROXY string</A><BR>
<A HREF="#3.14.">3.14.   PROXYPORT integer</A><BR>
<A HREF="#3.15.">3.15.   PROXYUSERPWD string</A><BR>
<A HREF="#3.16.">3.16.   RANDOM_FILE string</A><BR>
<A HREF="#3.17.">3.17.   RANGE string</A><BR>
<A HREF="#3.18.">3.18.   REFERER string</A><BR>
<A HREF="#3.19.">3.19.   SSLCERT string</A><BR>
<A HREF="#3.20.">3.20.   SSLCERTPASSWD string</A><BR>
<A HREF="#3.21.">3.21.   URL string</A><BR>
<A HREF="#3.22.">3.22.   USERAGENT string</A><BR>
<A HREF="#3.23.">3.23.   USERPWD string</A><BR>
<A HREF="#3.24.">3.24.   WRITEINFO string</A><BR>
<A HREF="#3.25.">3.25.   EGDSOCKET string</A><BR>
<A HREF="#3.26.">3.26.   POSTFIELDS string</A><BR>
<A HREF="#3.27.">3.27.   HTTPPROXYTUNNEL flag</A><BR>
<A HREF="#3.28.">3.28.   VERBOSE flag</A><BR>
<A HREF="#3.29.">3.29.   NOPROGRESS flag</A><BR>
<A HREF="#3.30.">3.30.   HEADER flag</A><BR>
<A HREF="#3.31.">3.31.   NOBODY flag</A><BR>
<A HREF="#3.32.">3.32.   FAILONERROR flag</A><BR>
<A HREF="#3.33.">3.33.   UPLOAD flag</A><BR>
<A HREF="#3.34.">3.34.   POST flag</A><BR>
<A HREF="#3.35.">3.35.   CRLF flag</A><BR>
<A HREF="#3.36.">3.36.   FTPLISTONLY flag</A><BR>
<A HREF="#3.37.">3.37.   FTPAPPEND flag</A><BR>
<A HREF="#3.38.">3.38.   NETRC flag</A><BR>
<A HREF="#3.39.">3.39.   FOLLOWLOCATION flag</A><BR>
<A HREF="#3.40.">3.40.   TRANSFERTEXT flag</A><BR>
<A HREF="#3.41.">3.41.   CLOSEPOLICY</A><BR>
<A HREF="#3.42.">3.42.   PUT flag</A><BR>
<A HREF="#3.43.">3.43.   SSL_VERIFYPEER flag</A><BR>
<A HREF="#3.44.">3.44.   FILETIME flag</A><BR>
<A HREF="#3.45.">3.45.   FRESH_CONNECT flag</A><BR>
<A HREF="#3.46.">3.46.   FORBID_REUSE flag</A><BR>
<A HREF="#3.47.">3.47.   HTTPGET flag</A><BR>
<A HREF="#3.48.">3.48.   TIMEOUT integer</A><BR>
<A HREF="#3.49.">3.49.   LOW_SPEED_LIMIT integer</A><BR>
<A HREF="#3.50.">3.50.   LOW_SPEED_TIME integer</A><BR>
<A HREF="#3.51.">3.51.   RESUME_FROM integer</A><BR>
<A HREF="#3.52.">3.52.   SSLVERSION integer</A><BR>
<A HREF="#3.53.">3.53.   TIMECONDITION string</A><BR>
<A HREF="#3.54.">3.54.   TIMEVALUE integer</A><BR>
<A HREF="#3.55.">3.55.   MAXREDIRS integer</A><BR>
<A HREF="#3.56.">3.56.   MAXCONNECTS integer</A><BR>
<A HREF="#3.57.">3.57.   CONNECTTIMEOUT integer</A><BR>
<A HREF="#3.58.">3.58.   HTTPHEADER string</A><BR>
<A HREF="#3.59.">3.59.   NOHTTPHEADER flag</A><BR>
<A HREF="#3.60.">3.60.   QUOTE string</A><BR>
<A HREF="#3.61.">3.61.   NOQUOTE flag</A><BR>
<A HREF="#3.62.">3.62.   POSTQUOTE string</A><BR>
<A HREF="#3.63.">3.63.   NOPOSTQUOTE flag</A><BR>
<A HREF="#3.64.">3.64.   FORMADD string</A><BR>
<A HREF="#3.65.">3.65.   HTTPPOST string</A><BR>
<A HREF="#3.66.">3.66.   ERRORBUFFER not implemented</A><BR>
<A HREF="#3.67.">3.67.   Options not implemented</A><BR>
</UL>
<A HREF="#4.">4.   curl::perform</A><BR>
<A HREF="#5.">5.   curl::info</A><BR>
<UL>
<A HREF="#5.1.">5.1.   EFFECTIVE_URL string</A><BR>
<A HREF="#5.2.">5.2.   HTTP_CODE integer</A><BR>
<A HREF="#5.3.">5.3.   FILETIME integer</A><BR>
<A HREF="#5.4.">5.4.   TOTAL_TIME real</A><BR>
<A HREF="#5.5.">5.5.   NAMELOOKUP_TIME real</A><BR>
<A HREF="#5.6.">5.6.   CONNECT_TIME real</A><BR>
<A HREF="#5.7.">5.7.   PRETRANSFER_TIME real</A><BR>
<A HREF="#5.8.">5.8.   SIZE_UPLOAD real</A><BR>
<A HREF="#5.9.">5.9.   SIZE_DOWNLOAD real</A><BR>
<A HREF="#5.10.">5.10.   SPEED_DOWNLOAD real</A><BR>
<A HREF="#5.11.">5.11.   SPEED_UPLOAD real</A><BR>
<A HREF="#5.12.">5.12.   HEADER_SIZE integer</A><BR>
<A HREF="#5.13.">5.13.   REQUEST_SIZE integer</A><BR>
<A HREF="#5.14.">5.14.   SSL_VERIFYRESULT integer</A><BR>
<A HREF="#5.15.">5.15.   CONTENT_LENGTH_DOWNLOAD real</A><BR>
<A HREF="#5.16.">5.16.   CONTENT_LENGTH_UPLOAD real</A><BR>
</UL>
<A HREF="#6.">6.   curl::finish</A><BR>
<A HREF="#7.">7.   curl::error</A><BR>
<A HREF="#8.">8.   curl::escape</A><BR>
<A HREF="#9.">9.   curl::unescape</A><BR>
<A HREF="#10.">10.   curl::getdate</A><BR>
<A HREF="#11.">11.   curl::version</A><BR>
</UL>
<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="1."><H1>1. Introduction</H1></A>


The CURL module provides easy and still powerful functions to perform various network
oriented actions that are based on URL to access data. For example CURL can perform
getting data via HTTP, HTTPS from web pages, POST data to web pages, transer file to
and from servers via FTP and so on.
<P>
To use the module the program has to import the BASIC "header" file named <font size="3"><tt>curl.bas</tt></font>. This
should be done using the command import:
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
import curl.bas
</PRE></FONT>
<P>
Note that there are no double quotes around the file name to include the definition of the
C implemented curl functions from the module interface header files include directory.
<P>
There are only a few functions defined in this file. The first function that an application
has to call is <font size="3"><tt>curl::init()</tt></font> to get a handle to a connection. A single program can use
several connections simultaneous, tough currently there is no possibility to download large
files asynchronous.
<P>
Following the initialization the program has to set several options calling <font size="3"><tt>curl::option</tt></font>, and then
should call the function <font size="3"><tt>curl::perform</tt></font> to actually perform the download/upload or other network
action. When a connection is not used anymore the function <font size="3"><tt>curl::finish</tt></font> can be called, though this
function is executed automatically for each connection when the interpreter exists. 
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
import curl.bas
ON ERROR GOTO CURL_ERROR
CURL = curl::init()
curl::option CURL,"URL","http://scriptbasic.com/html/index.html"
curl::option CURL,"FILE","C:\\ScriptBasicMirror\\html\\index.html"
curl::perform CURL
curl::finish CURL
STOP
CURL_ERROR:
PRINT "Some error happened while trying to download ScriptBasic home page. The error message is:\n"
PRINT curl::error()
STOP
</PRE></FONT>
<P>
For more information on other functions read the appropriate chapters.
<P>
The name CURL is made of the name of the programming language C in which CURL is implemented
and from the word URL. This text that you are reading is the documentation of the ScriptBasic
implementation of CURL. This implementation includes an interface module that containc C coded
BASIC callable function that map most (or some) of the CURL library functions. In other words
using this program yu can access most (or some) of the functions that the CURL library provides.
<P>
Altough the CURL library is quite flexible, there are some options that are altered in this
module to ease the use for BASIC programmers. For example the option POSTFIELDS accepts zero 
terminated string by default, because 1.) POST data usually does not contain zero character and 2.)
this is the easy way for C programmers. On the other hand there is a possibility, though more complex
to pass string and length to the option. Because all ScriptBasic strings are arbitrary binary data and
not zero character terminated strings this second method is followed.
<P>
Some of the options on the C level accept <font size="3"><tt>long</tt></font> numbers from a finite set and CURL C header files define
<font size="3"><tt>enum</tt></font> types for the purpose. In these cases the ScriptBasic interface requires strings being specified
by the BASIC program as option and convert to <font size="3"><tt>long</tt></font> as appropriate to CURL.
<P>
The option names in the original CURL interface are defined in <font size="3"><tt>enum</tt></font> and thus options are defined
as <font size="3"><tt>long</tt></font> constants. The BASIC interface works with strings, and converts the names specified as
strings to their appropriate value. This is (I assume) simpler for the BASIC programmers and on the other
hand induces only slight overhead as compared to network transfer times.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="2."><H1>2. curl::init</H1></A>

Call this function before any other curl action. This function will return a handle
to the curl session. This handle should be used as first argument to any further curl calls.
<P>

Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
CURL = curl::init()
</PRE></FONT>
<P>
The handle that the function returns is a small integer. However the program should not alter this value in any
way. The good practice is to store the value in a variable and use it as it is without caring about the real
value or type of the content.
<P>
If the initialization of the connection can not be performed <font size="3"><tt>MEMORY_LOW</tt></font> error occurs.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3."><H1>3. curl::option</H1></A>

Call this function to set the various options of the actual curl session.
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL, "option" [, value]
</PRE></FONT>
<P>
The various options that the current version of the module supports are listed in the following sections.
Note that the documentation is mainly copied from the original CURL lib documentation.
<P>
Some of the options require a string as a parameter. The strings usually should not contain zero character.
The exception is the option <font size="3"><tt>POSTFIELDS</tt></font>, which is handled in a special way to allow the programmer to send
arbitrary binary data as HTTP POST parameter.
<P>
The option names in the section titles in this document are followed by one of the words <I>string</I>, <I>integer</I> and <I>flag</I>.
<P>
<UL>
<LI>
Options followed by the word <I>string</I> need string argument. If the option value is not specified zero length
string is used. Because this is nonsense in most cases, you better use a third string argument for these options.
<LI>
Options followed by the word <I>flag</I> are yes/no type options. Presenting them without value means switching the
option on. To switch such an option off the programmer has to explicitely specify zero value as third argument.
In other words omitting the option value in such a case is the same as specifying <font size="3"><tt>1</tt></font> or <font size="3"><tt>TRUE</tt></font> or any other
non-zero value. To switch off a <I>flag</I> option you can specify the value as <font size="3"><tt>FALSE</tt></font> (which is zero in ScriptBasic)
for more readability.
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"VERBOSE"
curl::option CURL,"VERBOSE",TRUE
curl::option CURL,"VERBOSE",1
</PRE></FONT>
are the same as well as the oposit
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"VERBOSE",FALSE
curl::option CURL,"VERBOSE",0
</PRE></FONT>
are the same.
<LI>
Options followed by the word <I>integer</I> accept integer value. If the value is missing for such an option zero is used.
For example:
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"RESUME_FROM"
curl::option CURL,"RESUME_FROM",0
</PRE></FONT>
are the same.
</UL>
<P>

The option names are implemented case sensitive in this module, thus you can not use <font size="3"><tt>"verbose"</tt></font>
instead of <font size="3"><tt>"VERBOSE"</tt></font>. Also the programmer should type the option names precisely, no mispelling is
tolerated by the program.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.1."><H2>3.1. BUFFER_SIZE integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"BUFFER_SIZE",1024
</PRE></FONT>
<P>
When a file is downloaded but not stored in a file the function <font size="3"><tt>curl::perform(CURL)</tt></font> returns the content
of the downloaded file as a huge string. During the download this string is stored in a temporary buffer. The
size of this buffer increases gradually as more and more bytes come. If there are 10 bytes coming at a time then
the buffer will grow only ten bytes. This also means a new buffer allocation and copying the content of the buffer,
which consumes system resources, especially for large files.
<P>
If you happen to know the estimated size of the file, you can set the initial size of the buffer to a huge value using this
option. For example if you know that the file is 1024 bytes, you can set this option as in the example above. In that case
when the first byte comes from the URL the 1024 byte length buffer is increased and when the consecutive bytes come there is
space to store them without reallocating the buffer.
<P>
You need not worry about using this buffer when you handle small files, like web pages. If you see performace or memory
shortage problems, then you may consider this option along with the option <font size="3"><tt>FILE</tt></font> that helps you store the downloaded file
on disk.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.2."><H2>3.2. CAINFO string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"CAINFO","c:\\certs\mycert.pem"
</PRE></FONT>
<P>
Pass a string file naming holding the certificate to
verify the peer with. This only makes sense when used in combination with the
CURLOPT_SSL_VERIFYPEER option.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.3."><H2>3.3. COOKIE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"COOKIE","mycookie=is rather long"
</PRE></FONT>
<P>
Pass a string as parameter. It will be used to
set a cookie in the http request. The format of the string should be
<font size="3"><tt>[NAME]=[CONTENTS];</tt></font> Where <font size="3"><tt>NAME</tt></font> is the cookie name.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.4."><H2>3.4. COOKIEFILE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"COOKIEFILE","c:\\WINDOWS\\cookies.txt"
</PRE></FONT>
<P>
Pass a string as parameter. It should contain the
name of your file holding cookie data. The cookie data may be in Netscape /
Mozilla cookie data format or just regular HTTP-style headers dumped to a
file.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.5."><H2>3.5. CUSTOMREQUEST string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"CUSTOMREQUEST","MOVE"
</PRE></FONT>
<P>
Pass a string as parameter. It will be user
instead of GET or HEAD when doing the HTTP request. This is useful for doing
DELETE or other more obscure HTTP requests. Don't do this at will, make sure
your server supports the command first.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.6."><H2>3.6. FILE</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FILE","file_name"
</PRE></FONT>
<P>
Use this option to set the file name of the file where the result will be saved. When you set this option
the file is opened and truncated assumed that the program has appropriate privileges. Thus if there was a
file with the name the file will be overwrtitten even if the <font size="3"><tt>curl::perform</tt></font> function is not called. The file
is opened, when the option is set and kept opened so long as the connection is "finished" or another
<font size="3"><tt>INFILE</tt></font> or <font size="3"><tt>FILE</tt></font> option is specified for the connection.
<P>
If you donot specify any file to store the downloaded result, then the function <font size="3"><tt>curl::perform(CURL)</tt></font>
will return the file as a single huge string.
<P>
Comment on internals (if you do not understand what I am talking about, most probably you do not need to):
<P>
The underlying CURL library requests an opened file handle passed to the library and a function that
performs the file writing. The ScriptBasic interface gets the name of the file, opens the file, passes
the opened file pointer to the library and specifies the stadard <font size="3"><tt>fwrite</tt></font> function to write the file.
<P>
The pointer to the function <font size="3"><tt>fwrite</tt></font> is taken from the support table, thus is any preloaded module
altered this before setting this option the module function will be used.
<P>
The file is opened calling the system function <font size="3"><tt>fopen</tt></font> via the ScriptBasic support function calling stacks.
This means that if some module implements a hook function to control file access that will be taken into account
the same way as it is taken into accoung in the case of the BASIC command <font size="3"><tt>OPEN</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.7."><H2>3.7. FTPPORT string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FTPPORT","222"
</PRE></FONT>
<P>
Pass a string as parameter. It will be used to
get the IP address to use for the ftp PORT instruction. The PORT instruction
tells the remote server to connect to our specified IP address. The string may
be a plain IP address, a host name, an network interface name (under unix) or
just a '-' letter to let the library use your systems default IP address.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.8."><H2>3.8. HEADERFILE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HEADERFILE","file_name"
</PRE></FONT>
<P>
Use this option to set the file name of the file where the header coming from the server will be saved.
When you set this option the file is opened and truncated assumed that the program has appropriate privileges.
Thus if there was a file with the name the file will be overwrtitten even if the <font size="3"><tt>curl::perform</tt></font> function is
not called. The file is opened, when the option is set and kept opened so long as the connection is "finished" 
or another <font size="3"><tt>HEADERFILE</tt></font> option is specified for the connection.
<P>
Note: You need this option if you want to get the header and the body of a downloaded file into two separate
files. You can easily get the header and the body into a single file if you use the option <font size="3"><tt>HEADER</tt></font>. Altough
there is nothing that prevents, I see no real use of the two options aka <font size="3"><tt>HEADERFILE</tt></font> and flag <font size="3"><tt>HEADER</tt></font>) together.
But you are free to use them together.
<P>
Comment on internals (if you do not understand what I am talking about, most probably you do not need to):
<P>
The underlying CURL library requests an opened file handle passed to the library and a function that
performs the file writing. The ScriptBasic interface gets the name of the file, opens the file, passes
the opened file pointer to the library and specifies the stadard <font size="3"><tt>fwrite</tt></font> function to write the file.
<P>
The pointer to the function <font size="3"><tt>fwrite</tt></font> is taken from the support table, thus is any preloaded module
altered this before setting this option the module function will be used.
<P>
The file is opened calling the system function <font size="3"><tt>fopen</tt></font> via the ScriptBasic support function calling stacks.
This means that if some module implements a hook function to control file access that will be taken into account
the same way as it is taken into accoung in the case of the BASIC command <font size="3"><tt>OPEN</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.9."><H2>3.9. INFILE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"INFILE","file_name"
</PRE></FONT>
<P>
Use this option to set the file name of the file where the source is for file upload. When you set this option
the file is opened for reading, thus the file should exist and should be readable for the program. The file
is opened, when the option is set and kept opened so long as the connection is "finished" or another
<font size="3"><tt>INFILE</tt></font> or <font size="3"><tt>FILE</tt></font> option is specified for the connection.
<P>
You cannot use the options <font size="3"><tt>INTEXT</tt></font> and <font size="3"><tt>INFILE</tt></font> at the same time for the same connection. If you use both
the latter specified will be used.
<P>
Comment on internals (if you do not understand what I am talking about, most probably you do not need to):
<P>
The underlying CURL library requests an opened file handle passed to the library and a function that
performs the file writing. The ScriptBasic interface gets the name of the file, opens the file, passes
the opened file pointer to the library and specifies the stadard <font size="3"><tt>fread</tt></font> function to read the file.
<P>
The pointer to the function <font size="3"><tt>fread</tt></font> is taken from the support table, thus is any preloaded module
altered this before setting this option the module function will be used.
<P>
Curl optionally acepts the size of the file to report to the upload server. The implementation of this
option interfacing automatically gets the size of the file specified in the option and sets the underlying
option.
<P>
The file is opened calling the system function <font size="3"><tt>fopen</tt></font> via the ScriptBasic support function calling stacks.
This means that if some module implements a hook function to control file access that will be taken into account
the same way as it is taken into accoung in the case of the BASIC command <font size="3"><tt>OPEN</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.10."><H2>3.10. INTERFACE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"INTERFACE","16.193.68.55"
</PRE></FONT>
<P>
Pass a string as parameter. This set the interface name to use as outgoing
network interface. The name can be an interface name, an IP address or a host
name.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.11."><H2>3.11. INTEXT string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"INTEXT","""This is the content of the file
that we will upload.
"""
</PRE></FONT>
<P>
Use this option to set the content of the file for any kind of upload. This option can be used to upload 
small files via HTTP or FTP, which are generated on-the-fly by the BASIC program, and there is no need to
store the files locally.
<P>
You cannot use the options <font size="3"><tt>INTEXT</tt></font> and <font size="3"><tt>INFILE</tt></font> at the same time for the same connection. If you use both
the latter specified will be used.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.12."><H2>3.12. KRB4LEVEL string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"KRB4LEVEL","confidential"
</PRE></FONT>
<P>
Pass a string as parameter. Set the krb4 security level, this also enables
krb4 awareness.  This is a string, 'clear', 'safe', 'confidential' or
'private'.  If the string is set but doesn't match one of these, 'private'
will be used. Set the string to NULL to disable kerberos4. The kerberos
support only works for FTP.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.13."><H2>3.13. PROXY string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"PROXY","www.my-proxy.com:8080"
</PRE></FONT>
<P>
If you need libcurl to use a http proxy to access the outside world, set the
proxy string with this option. To specify port number in this string, append <font size="3"><tt>:[port]</tt></font> to
the end of the host name. The proxy string may be prefixed with
<font size="3"><tt>[protocol]://</tt></font> since any such prefix will be ignored.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.14."><H2>3.14. PROXYPORT integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"PROXYPORT",8080
</PRE></FONT>
<P>
Use this option to set the proxy port to use unless it is
specified in the proxy string <font size="3"><tt>PROXY</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.15."><H2>3.15. PROXYUSERPWD string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"PROXYUSERPWD","verhas:m23kkdUT"
</PRE></FONT>
<P>
Pass a string as parameter, which should be <font size="3"><tt>username:password</tt></font> to use for
the connection to the HTTP proxy. If the password is left out, you will be
prompted for it.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.16."><H2>3.16. RANDOM_FILE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"RANDOM_FILE","c:\\WINNT4\pagefile.sys"
</PRE></FONT>
<P>
Pass a string to a zero terminated file name. The file will be used to read
from to seed the random engine for SSL. The more random the specified file is,
the more secure will the SSL connection become.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.17."><H2>3.17. RANGE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"RANGE","3321-3322"
</PRE></FONT>
<P>
Pass a string as parameter, which should contain the specified range you
want. It should be in the format "X-Y", where X or Y may be left out. HTTP
transfers also support several intervals, separated with commas as in
<font size="3"><tt>"X-Y,N-M"</tt></font>. Using this kind of multiple intervals will cause the 
HTTP server to send the response document in pieces.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.18."><H2>3.18. REFERER string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"REFERER","http://www.scriptbasic.com"
</PRE></FONT>
<P>
Pass a string as parameter. It will be used to
set the <font size="3"><tt>Referer:</tt></font> header in the http request sent to the remote server. This
can be used to fool servers or scripts.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.19."><H2>3.19. SSLCERT string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"SSLCERT","???"
</PRE></FONT>
<P>
Pass a string as parameter. The string should be
the file name of your certficicate in PEM format.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.20."><H2>3.20. SSLCERTPASSWD string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"SSLCERTPASSWD","m23kkdUT"
</PRE></FONT>
<P>
Pass a string as parameter. It will be used as
the password required to use the <font size="3"><tt>SSLCERT</tt></font> certificate. If the password
is not supplied, you will be prompted for it.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.21."><H2>3.21. URL string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"URL","http://curl.haxx.se"
</PRE></FONT>
<P>
The actual URL to deal with. 
<P>
NOTE: this option is required to be set before <font size="3"><tt>curl::perform()</tt></font> is called.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.22."><H2>3.22. USERAGENT string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"USERAGENT","CURL 7.9.5 with SB Interface; v10b29"
</PRE></FONT>
<P>
Pass a string as parameter. It will be used to
set the <font size="3"><tt>User-Agent:</tt></font> header in the http request sent to the remote server. This
can be used to fool servers or scripts.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.23."><H2>3.23. USERPWD string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"USERPWD","verhas:m23kkdUT"
</PRE></FONT>
<P>
Pass a string as parameter, which should be <font size="3"><tt>username:password</tt></font> to use for
the connection. If the password is left out, you will be prompted for it.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.24."><H2>3.24. WRITEINFO string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"WRITEINFO",""
</PRE></FONT>
<P>
Pass a string as parameter. It will be used to
report information after a successful request.
<P>
As report and progress callback is not implemented in ScriptBasic CURL module, there
is not much use of this option.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.25."><H2>3.25. EGDSOCKET string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"EGDSOCKET","\\.\\edg"
</PRE></FONT>
<P>
Pass a string path name to the Entropy Gathering Daemon
socket. It will be used to seed the random engine for SSL.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.26."><H2>3.26. POSTFIELDS string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"POSTFIELDS","name=Edmund+Nielsen+Bohr&amp;address=Downing+street+11"
</PRE></FONT>
<P>
Pass a string as parameter, which should be the full data to post in a HTTP
post operation.
<P>
Note that CURL library also implements the option <font size="3"><tt>CURLOPT_POSTFIELDSIZE</tt></font> for C programmers.
That option is automatically called by the interface function, thus any binary BASIC string
can be used as post parameter.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.27."><H2>3.27. HTTPPROXYTUNNEL flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HTTPPROXYTUNNEL"
</PRE></FONT>
<P>
Set the parameter to get the library to tunnel all non-HTTP
operations through the given HTTP proxy. Do note that there is a big
difference to use a proxy and to tunnel through it. If you don't know what
this means, you probably don't want this tunnel option.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.28."><H2>3.28. VERBOSE flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"VERBOSE"
</PRE></FONT>
<P>
Set the parameter to get the library to display a lot of verbose
information about its operations. Very useful for libcurl and/or protocl
debugging and understanding.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.29."><H2>3.29. NOPROGRESS flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NOPROGRESS"
</PRE></FONT>
<P>
Setting the parameter tells the library to shut of the built-in progress meter
completely. (NOTE: future versions of the lib is likely to not have any
built-in progress meter at all).<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.30."><H2>3.30. HEADER flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HEADER"
</PRE></FONT>
<P>
Setting the parameter tells the library to include the header in the
output. This is only relevant for protocols that actually has a header
preceeding the data (like HTTP).<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.31."><H2>3.31. NOBODY flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NOBODY"
</PRE></FONT>
<P>
Setting the parameter tells the library to not include the body-part in the
output. This is only relevant for protocols that have a separate header and
body part.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.32."><H2>3.32. FAILONERROR flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FAILONERROR"
</PRE></FONT>
<P>
Setting the parameter tells the library to fail silently if the HTTP code
returned is equal or larger than 300. The default action would be to return
the page normally, ignoring that code.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.33."><H2>3.33. UPLOAD flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"UPLOAD"
</PRE></FONT>
<P>
Setting the parameter tells the library to prepare for an upload. The
option <font size="3"><tt>INFILE</tt></font> is also interesting for uploads.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.34."><H2>3.34. POST flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"POST"
</PRE></FONT>
<P>
Setting the parameter tells the library to do a regular HTTP post. This is a
normal <font size="3"><tt>application/x-www-form-urlencoded</tt></font> kind, which is the most commonly used
one by HTML forms. See the option <font size="3"><tt>POSTFIELDS</tt></font> option for how to specify the
data to post.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.35."><H2>3.35. CRLF flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"CRLF"
</PRE></FONT>
<P>
Convert unix newlines to CRLF newlines on FTP uploads.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.36."><H2>3.36. FTPLISTONLY flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FTPLISTONLY"
</PRE></FONT>
<P>
Setting the parameter tells the library to just list the names of an ftp
directory, instead of doing a full directory listin that would include file
sizes, dates etc.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.37."><H2>3.37. FTPAPPEND flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FTPAPPEND"
</PRE></FONT>
<P>
Setting the parameter tells the library to append to the remote file instead of
overwrite it. This is only useful when uploading to a ftp site.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.38."><H2>3.38. NETRC flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NETRC"
</PRE></FONT>
<P>
The parameter tells the library to scan your
<font size="3"><tt>~/.netrc</tt></font>
file to find user name and password for the remote site you are about to
access. Do note that curl does not verify that the file has the correct
properties set (as the standard unix ftp client does), and that only machine
name, user name and password is taken into account (init macros and similar
things aren't supported).<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.39."><H2>3.39. FOLLOWLOCATION flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FOLLOWLOCATION"
</PRE></FONT>
<P>
Setting the parameter tells the library to follow any Location: header that the
server sends as part of a HTTP header. NOTE that this means that the library
will resend the same request on the new location and follow new Location:
headers all the way until no more such headers are returned.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.40."><H2>3.40. TRANSFERTEXT flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"TRANSFERTEXT"
</PRE></FONT>
<P>
Setting the parameter tells the library to use ASCII mode for ftp transfers,
instead of the default binary transfer. For LDAP transfers it gets the data in
plain text instead of HTML and for win32 systems it does not set the stdout to
binary mode. This option can be useable when transfering text data between
system with different views on certain characters, such as newlines or
similar.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.41."><H2>3.41. CLOSEPOLICY</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"CLOSEPOLICY"
</PRE></FONT>
<P>
This option sets what policy libcurl should use when the
connection cache is filled and one of the open connections has to be closed to
make room for a new connection. This must be <font size="3"><tt>OLD</tt></font> or <font size="3"><tt>FRESH</tt></font>. If you specify <font size="3"><tt>OLD</tt></font>
as argument libcurl close the
oldest connection, the one that was created first among the ones in the
connection cache. If you specify <font size="3"><tt>FRESH</tt></font> libcurl close the
connection that was least recently used, that connection is also least likely
to be capable of re-use.
<P>
Example
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"CLOSEPOLICY","OLD"
curl::option CURL,"CLOSEPOLICY","FRESH"
</PRE></FONT>
<P>
Note that the values are checked by the module case sensitive, thus you can not write <font size="3"><tt>"old"</tt></font>
or <font size="3"><tt>"fresh"</tt></font> or mixed case words. Also the module <B>does not tolerate</B> any other form of the words,
like <font size="3"><tt>OLDEST</tt></font> or <font size="3"><tt>NEW</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.42."><H2>3.42. PUT flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"PUT"
</PRE></FONT>
<P>
Setting the parameter tells the library to use HTTP PUT a file. The file to put
must be set with option <font size="3"><tt>INFILE</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.43."><H2>3.43. SSL_VERIFYPEER flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"SSL_VERIFYPEER"
</PRE></FONT>
<P>
Set the flag value to make curl verify the peer's
certificate. The certificate to verify against must be specified with the
option <font size="3"><tt>CAINFO</tt></font> option.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.44."><H2>3.44. FILETIME flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FILETIME"
</PRE></FONT>
<P>
Pass a long. If it is a non-zero value, libcurl will attempt to get the
modification date of the remote document in this operation. This requires that
the remote server sends the time or replies to a time querying command. The
curl_easy_getinfo() function with the CURLINFO_FILETIME argument can be used
after a transfer to extract the received time (if any). (Added in 7.5)<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.45."><H2>3.45. FRESH_CONNECT flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FRESH_CONNECT"
</PRE></FONT>
<P>
Set the option to make the next transfer use a new connection by
force. If the connection cache is full before this connection, one of the
existinf connections will be closed as according to the set policy. This
option should be used with caution and only if you understand what it
does. Set to 0 to have libcurl attempt re-use of an existing connection.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.46."><H2>3.46. FORBID_REUSE flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FORBID_REUSE"
</PRE></FONT>
<P>
Set the option to make the next transfer explicitly close the
connection when done. Normally, libcurl keep all connections alive when done
with one transfer in case there comes a succeeding one that can re-use them.
This option should be used with caution and only if you understand what it
does. Set to 0 to have libcurl keep the connection open for possibly later
re-use.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.47."><H2>3.47. HTTPGET flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HTTPGET"
</PRE></FONT>
<P>
Set thisoption to force the HTTP request to get back
to <font size="3"><tt>GET</tt></font>. Only really usable if <font size="3"><tt>POST</tt></font>, <font size="3"><tt>PUT</tt></font> or a custom request have been used
previously using the same curl handle.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.48."><H2>3.48. TIMEOUT integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
' for example set the timeout to ten minutes
curl::option CurlHandle,"TIMEOUT",600
</PRE></FONT>
<P>
Pass an integer parameter containing the maximum time in seconds that you allow
the libcurl transfer operation to take. Normally, name lookups can take a
considerable time and limiting operations to less than a few minutes risk
aborting perfectly normal operations. This option will cause curl to use the
SIGALRM to enable timeouting system calls. <B>NOTE</B>
that this does not work in multi-threaded programs!<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.49."><H2>3.49. LOW_SPEED_LIMIT integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"LOW_SPEED_LIMIT",100
</PRE></FONT>
<P>
Pass an integer as parameter. It contains the transfer speed in bytes per second
that the transfer should be below during <font size="3"><tt>LOW_SPEED_TIME</tt></font> seconds for
the library to consider it too slow and abort.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.50."><H2>3.50. LOW_SPEED_TIME integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"LOW_SPEED_TIME",60
</PRE></FONT>
<P>
Pass an integer as parameter. It contains the time in seconds that the transfer
should be below the <font size="3"><tt>LOW_SPEED_LIMIT</tt></font> for the library to consider it too
slow and abort.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.51."><H2>3.51. RESUME_FROM integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"RESUME_FROM",3321
</PRE></FONT>
<P>
Pass an integer as parameter. It contains the offset in number of bytes that you
want the transfer to start from.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.52."><H2>3.52. SSLVERSION integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"SSLVERSION",3
</PRE></FONT>
<P>
Pass an integer as parameter. Set what version of SSL to attempt to use, 2 or
3. By default, the SSL library will try to solve this by itself although some
servers make this difficult why you at times will have to use this option.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.53."><H2>3.53. TIMECONDITION string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"TIMECONDITION","IFMODSINCE"
</PRE></FONT>
<P>
Pass a string as parameter. This defines how the <font size="3"><tt>TIMEVALUE</tt></font> time value is
treated. You can set this parameter to <font size="3"><tt>IFMODSINCE</tt></font> or
<font size="3"><tt>IFUNMODSINCE</tt></font>. This is aa HTTP-only feature.
<P>
Example
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"TIMECONDITION","IFMODSINCE"
curl::option CURL,"TIMECONDITION","IFUNMODSINCE"
</PRE></FONT>
<P>
Note that the values are checked by the module case sensitive, thus you can not write <font size="3"><tt>"ifmodsince"</tt></font>
or <font size="3"><tt>"ifmodsince"</tt></font> or mixed case words.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.54."><H2>3.54. TIMEVALUE integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CURL,"TIMECONDITION","IFMODSINCE"
curl::option CurlHandle,"TIMEVALUE",curl::getdate("2 days ago")
</PRE></FONT>
<P>
Pass an integer as parameter. This should be the time in seconds since 1 jan 1970,
and the time will be used as specified in the option <font size="3"><tt>TIMECONDITION</tt></font> or if that
isn't used, it will be <font size="3"><tt>IFMODSINCE</tt></font> by default. (In other words curl will fetch the
page only if that is newer than the specified time.)
<P>
To conveniently get such time-stamp values as accepted by this function as argument you
can use the ScriptBasic function <font size="3"><tt>TIMEVALUE</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.55."><H2>3.55. MAXREDIRS integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"MAXREDIRS",3
</PRE></FONT>
<P>
Pass an integer as parameter. The set number will be the redirection limit. If that many
redirections have been followed, the next redirect will cause an error. This
option only makes sense if the option <font size="3"><tt>FOLLOWLOCATION</tt></font> is used at the same
time.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.56."><H2>3.56. MAXCONNECTS integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"MAXCONNECTS",10
</PRE></FONT>
<P>
Pass an integer as parameter. The set number will be the persistant connection cache size. The
set amount will be the maximum amount of simultaneous connections that libcurl
may cache between file transfers. Default is 5, and there isn't much point in
changing this value unless you are perfectly aware of how this work and
changes libcurl's behaviour. Note: if you have already performed transfers
with this curl handle, setting a smaller <font size="3"><tt>MAXCONNECTS</tt></font> than before may cause
open connections to unnecessarily get closed.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.57."><H2>3.57. CONNECTTIMEOUT integer</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"CONNECTTIMEOUT",10
</PRE></FONT>
<P>
Pass an integer as parameter. It should contain the maximum time in seconds that you allow the
connection to the server to take.  This only limits the connection phase, once
it has connected, this option is of no more use. Set to zero to disable
connection timeout (it will then only timeout on the system's internal
timeouts). Specifying no value for this option is the same as specifying zero as all integer value options.
See also the <font size="3"><tt>TIMEOUT</tt></font> option.
<P>
<B>NOTE</B> that this does not work in multi-threaded programs!<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.58."><H2>3.58. HTTPHEADER string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HTTPHEADER","Accept: image/gif"
</PRE></FONT>
<P>
Use this option to specify a header to be sent to the server. If you add a header that is 
otherwise generated and used by libcurl internally, your added one will be used instead.
If you add a header with no contents as in <font size="3"><tt>Accept:</tt></font>, the internally used header will
just get disabled. Thus, using this option you can add new headers, replace
internal headers and remove internal headers.
<P>
You should call the function with this option for each extra header line that you want to add.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.59."><H2>3.59. NOHTTPHEADER flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NOHTTPHEADER"
</PRE></FONT>
<P>
Use this option to delete all previous <font size="3"><tt>HTTPHEADER</tt></font> options. This may be needed when you use a single
CURL connection to download several pages from the same server and did not call <font size="3"><tt>curl::finish</tt></font> and
<font size="3"><tt>curl::init()</tt></font> again. Until you call <font size="3"><tt>curl::finish</tt></font> or specify this option all header lines remain effective.
<P>
After setting this option you can set various <font size="3"><tt>HTTPHEADER</tt></font> option strings to build up a new list.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.60."><H2>3.60. QUOTE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"QUOTE","pwd"
</PRE></FONT>
<P>
Use this option to set arbitrary FTP commands that will be passed to the server prior to
your ftp request. You can set more than one values for this option. The commands will be 
executed in the order they are specified.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.61."><H2>3.61. NOQUOTE flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NOQUOTE"
</PRE></FONT>
<P>
Use this option to delete all previously set <font size="3"><tt>QUOTE</tt></font> FTP command strings. Read the documentation of
the option <font size="3"><tt>HTTPDEADER</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.62."><H2>3.62. POSTQUOTE string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"POSTQUOTE","site chmod 777 uploadedfile.txt"
</PRE></FONT>
<P>
Use this option to set arbitrary FTP commands that will be passed to the server after
your ftp request. You can set more than one values for this option. The commands will be 
executed in the order they are specified.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.63."><H2>3.63. NOPOSTQUOTE flag</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"NOPOSTQUOTE"
</PRE></FONT>
<P>
Use this option to delete all previously set <font size="3"><tt>POSTQUOTE</tt></font> FTP command strings. Read the documentation of
the option <font size="3"><tt>HTTPDEADER</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.64."><H2>3.64. FORMADD string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"FORMADD", _
     "NAME","field_name", _
     "VALUE","field_value", _
     "FILE","name_of_file_to_upload", _
     "FILENAME","reported_file_name", _
     "CONTENTTYPE","content/type", _
     "HEADER","extra-content: header"
</PRE></FONT>
<P>
Use this option to specify post parameters to be sent to the server when retrieving the URL.
There should be even number of arguments following the option <font size="3"><tt>"FORMADD"</tt></font>. Each pair of arguments
specify the argument type and the value. The argument types can be:
<P>
<UL>
<LI> <font size="3"><tt>"NAME"</tt></font> should be followed by the name of the argument
<LI> <font size="3"><tt>"VALUE"</tt></font> should be followed by the string value of the argument
<LI> <font size="3"><tt>"FILE"</tt></font> should be followed by the name of a file to be uploaded
<LI> <font size="3"><tt>"FILENAME"</tt></font> should be followed by the name of the file that you want to specify in the
post data to be sent to the server. If this value is not specified when uploading a file the
real file name specified following the <font size="3"><tt>"FILE"</tt></font> will be sent. You may not want to disclose the
real name of the file on the client and/or the full path to the file uploaded.
<LI> <font size="3"><tt>"CONTENTTYPE"</tt></font> should be followed by the content type of the uploaded file.
(multipart upload)
<LI> <font size="3"><tt>"HEADER"</tt></font> should be followed by extra header fields that are used for the specific content.
(multipart upload)
</UL><P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.65."><H2>3.65. HTTPPOST string</H2></A>

<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::option CurlHandle,"HTTPPOST" [,"name1","value1",...,"nameN","valueN"]
</PRE></FONT>
<P>
Use this option to specify the post parameters to be sent to the server when retrieving the URL.
<P>
Note that this option was greatly changed and is not compatible with fomer versions. 
<P>
The optional
arguments <font size="3"><tt>name1, name2, ..., nameN</tt></font> specify the names of the post fields and
<font size="3"><tt>value1, value2, ..., valueN</tt></font> spefify the values. This way you can specify simple text post
parameters. If you want to specify more complex post parameters, like file upload, you have
to use the option <font size="3"><tt>FORMADD</tt></font>. 
<P>
Use the option without optional arguments to close the repetitive use of the option <font size="3"><tt>FORMADD</tt></font>. In
other word: if you specify the POST arguments using the option <font size="3"><tt>FORMADD</tt></font> you also have to use the
option <font size="3"><tt>HTTPPOST</tt></font> after the last <font size="3"><tt>FORMADD</tt></font> option invocation.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.66."><H2>3.66. ERRORBUFFER not implemented</H2></A>

This option is implemented in the original CURL library, but is not implemented in this interface.
The ScriptBasic interface sets this option automatically and you can access the error message calling the
BASIC function <font size="3"><tt>curl::error()</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="3.67."><H2>3.67. Options not implemented</H2></A>
<UL>
<LI> <font size="3"><tt>CURLOPT_STDERR</tt></font> is used in the CURL library to specify an alternate strean instead of <font size="3"><tt>stderr</tt></font>
for erro output. This is not supported by the ScriptBasic interface.
<P>
<LI> <font size="3"><tt>CURLOPT_PROGRESSFUNCTION</tt></font> is used in conjunction with <font size="3"><tt>CURLOPT_PROGRESSDATA</tt></font> to specify a progress
function that CURLIB library calls from time to time to allow progress indication for the user. This is
not implemented in the ScriptBasic interface.
<P>
<LI> <font size="3"><tt>CURLOPT_PASSWDFUNCTION</tt></font> is used along with the option <font size="3"><tt>CURLOPT_PASSWDDATA</tt></font> to specify a function
that returns the password for connections that need password, but no password is specified. This is not
implemented in ScriptBasic.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="4."><H1>4. curl::perform</H1></A>

Call this function to perform the action that was initialized using the function
<font size="3"><tt>curl::init()</tt></font> and <font size="3"><tt>curl::option()</tt></font>
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::perform CURL
</PRE></FONT><P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5."><H1>5. curl::info</H1></A>

Call this function to get information on the performed action
after <font size="3"><tt>curl::perform</tt></font> was called
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
INFO = curl::info(CURL,info)
</PRE></FONT>
<P>
The argument <font size="3"><tt>info</tt></font> should be string and can take one of the valueslisted in the following sections. The return
value is either a string, integer or real value according to the type of the requested information. The possible
string arguments should be used in upper case letters, and should be precisely typed, no abbreviations or alternate
forms of the words are recognized by the subroutine.
<P>
Note that the following sections were mainly compiled from the documentation of the original C language CURL package
documentation <font size="3"><tt>curl_easy_getinfo.3</tt></font> man page.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.1."><H2>5.1. EFFECTIVE_URL string</H2></A>
The function returns the string of the effective URL of the last transfer.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.2."><H2>5.2. HTTP_CODE integer</H2></A>
The function returns the integer status value of the lasttransfer.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.3."><H2>5.3. FILETIME integer</H2></A>
The function returns the remote time of the retrieved document. If the result is zero it means that the time
can not be determined for some reson. It may happen that the server hides the time, or does not support the
command that is used to retrieve the file time.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.4."><H2>5.4. TOTAL_TIME real</H2></A>
The function returns a real number; the total transaction time in seconds for the previous transfer. The returned
value is real and not integer because the fractional seconds are also taken into account.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.5."><H2>5.5. NAMELOOKUP_TIME real</H2></A>
The function returns a real number; the time, in seconds, it took from the start until the name resolving 
was completed.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.6."><H2>5.6. CONNECT_TIME real</H2></A>
The function returns a real number; 
the time, in seconds, it took from the
start until the connect to the remote host (or proxy) was completed.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.7."><H2>5.7. PRETRANSFER_TIME real</H2></A>
The function returns a real number; 
the time, in seconds, it took from the
start until the file transfer is just about to begin. This includes all
pre-transfer commands and negotiations that are specific to the particular
protocol(s) involved.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.8."><H2>5.8. SIZE_UPLOAD real</H2></A>
The function returns a real number; 
the total amount of bytes that were
uploaded.
<P>
I see no reason why this is a real number but the underlying CURL library returns a <font size="3"><tt>double</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.9."><H2>5.9. SIZE_DOWNLOAD real</H2></A>
The function returns a real number; 
total amount of bytes that were
downloaded.
<P>
I see no reason why this is a real number but the underlying CURL library returns a <font size="3"><tt>double</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.10."><H2>5.10. SPEED_DOWNLOAD real</H2></A>
The function returns a real number; 
the average download speed, in bytes/seconds, that curl
measured for the complete download.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.11."><H2>5.11. SPEED_UPLOAD real</H2></A>
The function returns a real number; 
the average upload speed, in bytes/seconds, that curl
measured for the complete upload.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.12."><H2>5.12. HEADER_SIZE integer</H2></A>
The function returns an integer;
the toal number of bytes received in all headers during the transfer.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.13."><H2>5.13. REQUEST_SIZE integer</H2></A>
The function returns an integer;
the total number of bytes of the issued
requests. This is so far only for HTTP requests. Note that this may be more
than one request if <font size="3"><tt>FOLLOWLOCATION</tt></font> was set using <font size="3"><tt>curl::option</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.14."><H2>5.14. SSL_VERIFYRESULT integer</H2></A>
The function returns an integer;
the result of the certification verification that was requested (using <font size="3"><tt>curl::option</tt></font> with the option <font size="3"><tt>SSL_VERIFYPEER</tt></font>).<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.15."><H2>5.15. CONTENT_LENGTH_DOWNLOAD real</H2></A>
The function returns a real number;
the content-length of the download. This
is the value read from the <font size="3"><tt>Content-Length:</tt></font> field.
<P>
I see no reason why this is a real number but the underlying CURL library returns a <font size="3"><tt>double</tt></font>.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="5.16."><H2>5.16. CONTENT_LENGTH_UPLOAD real</H2></A>
The function returns a real number;
the specified size of the upload.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="6."><H1>6. curl::finish</H1></A>

You can call this function to close the connection that was used by CURL and to release
all resources that were allocated to handle the connection. To call this function is not
a must as all the releasing tasks are automatically performed as soon as the interpreter
finishes execution the BASIC program. However it is a good practice to call this functions
especially if you want to access the file the perform routine downloaded.
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
curl::finish CURL
</PRE></FONT>
<P>
This function closes the connection to the remote URL, closes the local file (if there was opened any), and
releases the memory that was used for the connection.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="7."><H1>7. curl::error</H1></A>

If any error has happened this function can be used to retrieve the error message that the underlying
CURL library supplied.
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
print curl::error(CURL)
</PRE></FONT><P><a href="#contents">[Contents]</A><BR>
<P>
<A name="8."><H1>8. curl::escape</H1></A>

This function will convert the given input string to an URL encoded string and
return that string. All input characters that are not a-z,
A-Z or 0-9 will be converted to their "URL escaped" version.
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
URLencoded = curl::escape(URLnonencoded)
</PRE></FONT><P><a href="#contents">[Contents]</A><BR>
<P>
<A name="9."><H1>9. curl::unescape</H1></A>

This function will convert the given URL encoded input string to a "plain
string" and return that string. All input characters that are encoded <font size="3"><tt>%XX</tt></font>
where <font size="3"><tt>XX</tt></font> is a to digit hexadecimal character will be converted to their
plain text version. All <font size="3"><tt>+</tt></font> characters that are after the (or a) <font size="3"><tt>?</tt></font> character
are converted to space.
<P>
Usage:
<FONT SIZE="3" COLOR="BLUE"><PRE>
URLencoded = curl::escape(URLnonencoded)
</PRE></FONT>
<P>
This behaviour of this function makes it easy to unescape URLs that contain not
only the CGI GET parameter of the URL, but the whole URL. For exaple:
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
print curl::unescape("http://www.kuka+muka.com/mypage.asp?name=Linus+Nielsen")
</PRE></FONT>
<P>
will print
<P>
<FONT SIZE="3" COLOR="BLUE"><PRE>
http://www.kuka+muka.com/mypage.asp?name=Linus Nielsen
</PRE></FONT>
<P>
which is much better than having the web server name converted to something containing a space.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="10."><H1>10. curl::getdate</H1></A>

This function returns the number of seconds since January 1st 1970, for the
date and time that the <I>datestring</I> parameter specifies. 
Read further in the date string parser section below.
<P>
If the input string can not be parsed the function return zero.
<P>
The following is copied from the original <font size="3"><tt>curl_getdate</tt></font> manual page.
<P>
<B>PARSING DATES AND TIMES</B>
<P>
A <font size="3"><tt>"date"</tt></font> is a string, possibly empty, containing many items separated by
whitespace. The whitespace may be omitted when no ambiguity arises.  The
empty string means the beginning of today (i.e., midnight).  Order of the
items is immaterial.  A date string may contain many flavors of items:
<P>
<UL>
<LI> calendar date items
This can be specified in a number of different ways. 
Including <font size="3"><tt>1970-09-17</tt></font>, <font size="3"><tt>70-9-17</tt></font>, <font size="3"><tt>70-09-17</tt></font>, <font size="3"><tt>9/17/72</tt></font>,
<font size="3"><tt>24 September 1972</tt></font>, <font size="3"><tt>24 Sept 72</tt></font>, <font size="3"><tt>24 Sep 72</tt></font>, <font size="3"><tt>Sep 24, 1972</tt></font>,
<font size="3"><tt>24-sep-72</tt></font>, <font size="3"><tt>24sep72</tt></font>.
The year can also be omitted, for example: <font size="3"><tt>9/17</tt></font> or <font size="3"><tt>sep 17</tt></font>.
<P>
<LI> time of the day items
This string specifies the time on a given day. Syntax supported includes:
<font size="3"><tt>18:19:0</tt></font>, <font size="3"><tt>18:19</tt></font>, <font size="3"><tt>6:19pm</tt></font>, <font size="3"><tt>18:19-0500</tt></font>
(for specifying the time zone as well).
<P>
<LI> time zone items
Specifies international time zone. There are a few acronyms supported, but in
general you should instead use the specific realtive time compared to
UTC. Supported formats include: <font size="3"><tt>-1200</tt></font>, <font size="3"><tt>MST</tt></font>, <font size="3"><tt>+0100</tt></font>.
<P>
<LI> day of the week items
Specifies a day of the week. If this is mentioned alone it means that day of
the week in the future.
<P>
Days of the week may be spelled out in full: <font size="3"><tt>Sunday</tt></font>, <font size="3"><tt>Monday</tt></font>, etc or they
may be abbreviated to their first three letters, optionally followed by a
period.  The special abbreviations <font size="3"><tt>Tues</tt></font> for <font size="3"><tt>Tuesday</tt></font>, <font size="3"><tt>Wednes</tt></font> for
<font size="3"><tt>Wednesday</tt></font> and <font size="3"><tt>Thur</tt></font> or <font size="3"><tt>Thurs</tt></font> for <font size="3"><tt>Thursday</tt></font> are also allowed.
<P>
A number may precede a day of the week item to move forward supplementary
weeks.  It is best used in expression like <font size="3"><tt>third monday</tt></font>.  In this context,
<font size="3"><tt>last DAY</tt></font> or <font size="3"><tt>next DAY</tt></font> is also acceptable; they move one week before or
after the day that DAY by itself would represent.
<P>
<LI> relative items
A relative item adjusts a date (or the current date if none) forward or
backward. Example syntax includes: <font size="3"><tt>1 year</tt></font>, <font size="3"><tt>1 year ago</tt></font>, <font size="3"><tt>2 days</tt></font>, 
<font size="3"><tt>4 weeks</tt></font>.
<P>
The string <font size="3"><tt>tomorrow</tt></font> is worth one day in the future (equivalent to <font size="3"><tt>day</tt></font>),
the string <font size="3"><tt>yesterday</tt></font> is worth one day in the past (equivalent to <font size="3"><tt>day ago</tt></font>).
<P>
<LI> pure numbers
If the decimal number is of the form <font size="3"><tt>YYYYMMDD</tt></font> and no other calendar date item
appears before it in the date string, then <font size="3"><tt>YYYY</tt></font> is read as the year, <font size="3"><tt>MM</tt></font> as the
month number and <font size="3"><tt>DD</tt></font> as the day of the month, for the specified calendar date.
</UL>
<P>
<B>AUTHORS</B>
<P>
Originally written by Steven M. Bellovin <font size="3"><tt>smb@research.att.com</tt></font> while at the
University of North Carolina at Chapel Hill.  Later tweaked by a couple of
people on Usenet.  Completely overhauled by Rich $alz <font size="3"><tt>rsalz@bbn.com</tt></font> and Jim
Berets <font size="3"><tt>jberets@bbn.com</tt></font> in August, 1990.<P><a href="#contents">[Contents]</A><BR>
<P>
<A name="11."><H1>11. curl::version</H1></A>

Returns a human readable string with the version number of
libcurl and some of its important components (like OpenSSL
version) that were used to create the ScriptBasic module
<font size="3"><tt>curl.dll</tt></font> under Windows NT or <font size="3"><tt>curl.so</tt></font> under UNIX.
<P>
The module links the CURL library static thus you have to
recompile it or download a newer binary of the module if
there is a newer version of the CURL library even if you
have installed a newer version of the library itself.
 
