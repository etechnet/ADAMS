#! /bin/sh
#
# This file will create the debian package after
# ScriptBasic was compiled and configured
#
# This file is not a source file, do not edit!
#
# This file was generated by the program setup.pl
# when started with the option --install
#
CONFIGDIR=deb/scriba/etc/scriba
INCLUDE=deb/scriba/usr/share/scriba/include
SOURCE=deb/scriba/usr/share/scriba/source
MODULE=deb/scriba/usr/local/lib/scriba
LIB=deb/scriba/usr/local/lib
CACHE=deb/scriba$(HOME)/.scriba/cache
HEBTEMP=deb/scriba$(HOME)/.scriba/hebtemp
BIN=deb/scriba/usr/bin
LOG=deb/scriba$(HOME)/.scriba
ETC=deb/scriba/etc/init.d

#
# clean old version of the package
#
mkdir -p deb/scriba
rm -rf deb/scriba/* 2>/dev/null
rm deb/*.deb 2>/dev/null

#
# insert the current build number into the control file
#
perl preparedeb.pl

#
# copy the control files to the place where they have to be
# to build the debian package
#
mkdir -p deb/scriba
cp -R deb/DEBIAN deb/scriba
rm -rf deb/scriba/DEBIAN/CVS
chown root:root deb/scriba/DEBIAN
chown root:root deb/scriba/DEBIAN/*
chmod 075 deb/scriba/DEBIAN
chmod 075 deb/scriba/DEBIAN/*

mkdir -p $CONFIGDIR
mkdir -p $BIN
mkdir -p $INCLUDE
mkdir -p $SOURCE
mkdir -p $MODULE
mkdir -p $LIB
mkdir -p $CACHE
mkdir -p $HEBTEMP
mkdir -p $LOG
mkdir -p $ETC

cp ./bin/exe/scriba $BIN
cp ./bin/exe/sbhttpd $BIN
cp ./etc-init.d-sbhttpd $ETC/sbhttpd
cp ./bin/mod/dll/*.so $MODULE
cp ./bin/lib/*.a $LIB
cp ./bin/mod/lib/*.a $LIB
cp ./include/* $INCLUDE
./bin/exe/scriba  -f $CONFIGDIR/basic.conf -k scriba.conf.unix.lsp
cp ./heber.bas $SOURCE

chown -R root:root deb/scriba
chmod -R 0755 deb
chmod -R 0777 $CACHE
chmod -R 0777 $HEBTEMP
chmod -R 0777 $LOG
cd deb
dpkg --build scriba
mv scriba.deb scriba-v`cat ../version.txt`b`cat ../build.txt`-1_i386.deb
cd ..
